<!DOCTYPE html>
<html>
  <head>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="https://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <!-- Bootstrap -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
      integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
      crossorigin="anonymous"
    />
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
      integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
      crossorigin="anonymous"
    ></script>
    <!-- Dark mode -->
    <script src="js/dark_mode.js"></script>
    <!-- CSS -->
    <link href="css/cortex.css" rel="stylesheet" type="text/css" media="all" />
    <link
      href="css/dark_mode.css"
      rel="stylesheet"
      type="text/css"
      media="all"
    />
    <link href="css/index.css" rel="stylesheet" type="text/css" media="all" />
  </head>

  <body>
    <h1 class="search_header">Cortex</h1>
    <center>
      <script>
        function build_user_snapshots_url() {
          var user_snapshots_url =
            "/users/id=" +             
            document.getElementById('user_id').value;
          var user_snapshots_form = document.getElementById("user_snapshots_form");
          user_snapshots_form.action = user_snapshots_url;
        }
      </script>
      <form id="user_snapshots_form" autocomplete="off" onsubmit=build_user_snapshots_url()>
        <div class="search_wrapper">
          <div>
            <div class="search_boxes">
              <div class="search_box">
                <input
                  id="user_name"
                  type="text"
                  placeholder="Search by user name..."
                />
              </div>
              <div class="search_box">
                <input
                  id="user_id"
                  type="text"                  
                  placeholder="Search by ID..."
                />
              </div>
              <div>
                <input type="submit" value="View" />
              </div>
            </div>
          </div>
        </div>
      </form>
    </center>

    <!-- Auto Complete -->
    <script>

      var arrUsersData = %users_converted%;

      var arrUserNames = [];
      var arrUserIDs = [];

      $.map(arrUsersData, function (item, i) {
        arrUserNames.push({
          label: item[0],
          data: [item[1]],
        });
        arrUserIDs.push({
          label: item[1],
          data: [item[0]],
        });
      });

      $("#user_name").autocomplete({
        minLength: 0,
        source: arrUserNames,
        messages: {
          noResults: "no results.",
          results: function (amount) {
            return amount + " results.";
          },
        },
        select: function (event, ui) {
          $("#user_name").val(ui.label);
          $("#user_id").val(ui.item.data[0]);
        },
        change: function (event, ui) {
          $.each([$(".ui-helper-hidden-accessible")], function () {
            this.empty();
          });
        },
      });

      $("#user_id").autocomplete({
        minLength: 0,
        source: arrUserIDs,
        messages: {
          noResults: "no results.",
          results: function (amount) {
            return amount + " results.";
          },
        },
        select: function (event, ui) {
          $("#user_name").val(ui.item.data[0]);
          $("#user_id").val(ui.label);
        },
        change: function (event, ui) {
          $.each([$(".ui-helper-hidden-accessible")], function () {
            this.empty();
          });
        },
      });
    </script>

    <!-- Dark Mode -->
    <script>
      window.dhDarkModeHandler = new DarkModeHandler();
    </script>
    <button
      id="dark_mode_button"
      onclick="window.dhDarkModeHandler.toggleDarkModeForSession()"
      title="Come to the dark side! ðŸª"
    >
      Toggle dark mode ðŸŒ“
    </button>
  </body>
</html>
